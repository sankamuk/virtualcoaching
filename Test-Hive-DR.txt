create table sourcetab1 ( id int, name string, age int) partitioned by ( country string ) row format delimited fields terminated by ',' stored as textfile ;
load data inpath '/user/hadoop/set1/india' into table sourcetab1 partition (country='india') ;

0: jdbc:hive2://server:10000> SET hive.exec.dynamic.partition = true;
No rows affected (0.012 seconds)
0: jdbc:hive2://server:10000> SET hive.exec.dynamic.partition.mode = nonstrict;
No rows affected (0.005 seconds)

create table parttab1 ( id int, name string, age int) partitioned by ( country string ) row format delimited fields terminated by ',' stored as textfile ;

insert overwrite table parttab1 partition (country) select id, name, age, country from sourcetab1 ;

hadoop distcp -overwrite /data/hive/sourcedb.db/parttab1/.snapshot/s2/ /data/hive/targetdb.db/parttab1/

ALTER TABLE parttab1 ADD PARTITION (country='turkey')

insert overwrite table parttab1 partition (country) select id, name, age, country from sourcetab2 ;
